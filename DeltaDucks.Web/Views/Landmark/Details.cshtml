@using Microsoft.AspNet.Identity
@model DeltaDucks.Web.ViewModels.LandmarkViewModel

@{
    ViewBag.Title = "Details";
}
<h2>@Model.Name</h2>
<div>
    <hr />
    @Html.HiddenFor(model => model.LandmarkId)
    <h5>Номер: @Model.Number</h5>
    <div><p>@Model.Information</p></div>
</div>
<div>
    <h4>Снимки</h4>
    @foreach (var picture in ViewBag.Pictures)
    {
        <img src="@String.Format("data:image/png;base64,{0}", Convert.ToBase64String(picture))" style="width: 160px; height: 160px; background: #FFFFFF;
                                      margin: auto;
                                      padding: 6px;
                                      box-shadow: 0px 0px 20px #888;" />
    }
</div>
<div>
<hr />
    <div>
        <h4> @Model.Comments.Count Comments: </h4>
    </div>

    @foreach (var comment in Model.Comments)
    {
        <div style="border-bottom: 1px solid rgba(0, 0, 0, 0.1); margin-bottom: 5px;">
            <div>@comment.Text</div>
            @if (comment.Author != null)
            {
                <div>
                    <strong>от @comment.Author.FirstName @comment.Author.LastName</strong> (<i><strong>@comment.Author.UserName</strong></i>)
                    @if (comment.AuthorId == User.Identity.GetUserId())
                    {
                        <a href="@Url.Action("Edit", "Comment", new {id = comment.CommentId, landmarkId = Model.LandmarkId, number = Model.Number})" class="btn btn-primary btn-sm">Edit my comment</a>
                        <a href="@Url.Action("Delete", "Comment", new {commentId = comment.CommentId, number = Model.Number})"class="btn btn-danger btn-sm">Delete my comment</a>
                    }
                </div>
            }
            else
            {
                @:By Anonymous
            }
            <div style="font-size: x-small;">
                Posted on <i>@comment.DateCreated.ToString("dd.MM.yyyy")</i>
            </div>
        </div>
    }
</div>

<a href="@Url.Action("Create", "Comment", new { id = Model.LandmarkId, number = Model.Number })" class="btn btn-default">Add new comment</a>
<p style="margin: 15px" class="btn btn-default">
    @Html.ActionLink("Назад", "Index", new { page = Model.Number / 10 + (Model.Number % 10 == 0 ? 0 : 1) })
</p>
